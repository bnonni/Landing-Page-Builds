<style>
div.wrapper{
    overflow: hidden;
}
.content {
	padding: 0;
}
h2#custRevs {
    color: #2d397d;
    border: none;
    font-size: 2rem;
    margin: 2.5% auto;
    padding: 0 10%;
	width: 100%;
    font-weight: 700;
    line-height: 2rem;
    text-align: center;
    font-family: sucrose_slantbold;
}
div.reviewSlideClass {
    width: 100%;
    margin: -9px 0 0 2px;
    padding: 3% 0;
    background-image: url(https://rotorooter.com/images/rr-z2-reviews-bkg-mobile.png);
	background-position: 0 0;
	background-size: cover;
    background-repeat: no-repeat;
	position: relative;
	clear: both;
}
div#reviewSlides {
	padding: 1% 0;
	display: none;
}
section#main-content div.ppc-content button{
    outline: none;
}
button.slick-prev.slick-arrow, button.slick-next.slick-arrow {
	z-index: 2;
	outline: 0;
	top: 35%;
	right: 2%;
	font-size: 66px;
	background: 0;
	padding: 0;
	color: #9397B2;
	border: none;
	position: absolute;
}
button.slick-prev.slick-arrow  {
	left: 2%;
}
div.reviewSlideClass blockquote{
	border: none;
    outline: none;
    margin: 0;
	padding: 2.5px 13px 10.5px 21px;
}
div.reviewSlideClass blockquote div.rating{
    padding: 0;
	text-align: center;
    line-height: 1.25rem;	
}
div.reviewSlideClass blockquote div.rating span.star{	
    color: #D53B44;
    padding: 0;
    font-size: 2em;
    outline-color: #D53B44;
}
div.reviewSlideClass blockquote div.review-comment{
	width: auto;
    margin: 0 0 0 8px;
    padding: 4% 5%;
    font-size: 1.5rem;
    text-align: center;
    display: block;
}
div.reviewSlideClass blockquote p.author-locale{
    margin: 0 0 0 -17px;
    padding: 0;
	text-align: center;
}
div.reviewSlideClass blockquote p.author-locale strong{
    font-size: 1.25rem;
    padding: 0;
}
div.reviewSlideClass blockquote p.author-locale span {
	margin: 0 8px 0 0;
}
section#reviews{
	width: 100%;
	height: auto;
	margin: 15px 0 0 0;
	padding-left: 0;
	text-align: left;
	display: none;
}
.scheduleServiceClass{
	background-color: #506bb7;
    border: 2px solid #fff;
    border-radius: .25rem;
    bottom: 5.25rem;
    color: #fff;
    display: block;
    font-size: 1.125rem;
    height: 3rem;
    line-height: 2rem;
    text-align: center;
    width: 16rem;
	margin: 0 auto 6px auto;
    /*margin: 0 0 6px 0;*/
}
.scheduleServiceClass.desktop {
	display: block;
}
.scheduleServiceClass.mobile {
	display: none;
}
div.coupon-div{
 	background-color: #FFFFFF;
    margin: 0 auto;
    display: inline-block;
    width: 100%;
    font-family: sucrose_slantbold;
    padding: 5px;
}	
div.coupon-div img{
    width: 34px;
}
a.a-coupon{
    color: #D4323B;
    text-decoration: underline;
	margin-left: 2%;
    padding: 0 1rem;
	vertical-align: middle;
}
a.a-coupon .tk-material-icons {
	top: 6px;
}
#rrVan {
	display: none;
}
#rrRedVan{
  display: inline-block;
}
a#back-to-top{
    clear: both;
    color: #3c5aaf;
    display: block;
    font-size: 1rem;
    height: 7rem;
    line-height: 7rem;
    text-align: center;
    text-transform: uppercase;
    margin-top: 0;
}
div#back-to-top-container{
	height: auto;
	width: auto;
	margin: 0 auto;
	padding: 50px 0 50px 0;
}
@media screen and (max-width: 993px) {
	section#reviews{
		margin: 15px auto;
		text-align: center;
	}
	.scheduleServiceClass {
		margin: 0 auto 6px auto;
		height: auto;
	}
	.scheduleServiceClass.desktop {
		display: none;
	}
	.scheduleServiceClass.mobile {
		display: block;
	}
	div.coupon-div {
		background-color: #D4323B;
		padding: 5px;
	}	
	a.a-coupon{
		color: #fff;
		text-decoration: none;
		font-size: 16px;
	}
	a.a-coupon .tk-material-icons {
		top: 4px;
	}
	#rrVan {
		display: inline-block;
	}
	#rrRedVan{
	  display: none;
	}
}
</style>
<style>
/* WH Styles */
@media(min-width: 768px) {
	body#ppc-page .panel-default .panel-body.panel-body-desktop {
		height: 9rem;
		padding: 1.05rem 0 0;
	}

	body#ppc-page .panel-default .panel-body.panel-body-desktop .call-now-text {
		font-size: 2.25rem;
	}

	body#ppc-page .panel-default .panel-body.panel-body-desktop .phone-formatted {
		font-size: 3.5rem;
		height: 3.5rem;
	}

	body#ppc-page .panel-default .schedule-service {
		bottom: 1.25rem;
		font-size: 1.5rem;
		height: 3rem;
		line-height: 2rem;
		width: 22rem;
	}
}
/* End WH Styles */
</style>
<script>
var rrCity,rrState,mobileCarrier="${profile.geolocation.mobileCarrier}";
var params={};location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(s,k,v){params[k]=v});
try {
    function triggerEScheduleClicks() {
		try {
			adobe.target.trackEvent( {
				mbox: "ScheduleServiceModuleAppears"
			});
		} catch(e) {}
    }
    var pnccnt=0;
    function tallyPhnNumClicks() {
		try {
			pnccnt+=1,
			adobe.target.trackEvent( {
				mbox:"PhoneNumberClick", params: {
					PhoneNumberClick: pnccnt
				}
			});
		} catch(e) {}
    }
	function removeListeners() {
		try {
			$(document).find(".btn-group-schedule-service-online").click(function(c) {});
			var c=$(document).find(".btn-red");
			$.each(c, function(c, n) {
				"eschedule-embedded-form"==$(n).attr("data-gacategory")&&$(n).click(function(c) {});
			});
			$(document).find("body#ppc-page section#hero #mPanel.schedule-service-panel > .panel-body-wrap a.schedule-service").click(function(c) {});
			$(document).find("button.schedule-service").click(function(c) {});
			$(document).find(".phone-formatted").click(function(c) {});
			$(document).find(".market-phones").click(function(c) {});
			$(document).find(".desktop-header-phone").click(function(c) {});
			$(document).find(".call-phone-number").click(function(c) {});
			$(document).find("#nav-phone-number").click(function(c) {});
			$(document).find(".local-page-phone").click(function(c) {});
			$(document).find("#mob-call-now").click(function(c) {});
			$(document).find("#local-page-contactus-sticky").click(function(c) {});
		} catch(e) {}
	}
    function attachListeners() {
		try {
			$(document).find(".btn-group-schedule-service-online").click(function(c) {
				triggerEScheduleClicks()
			});
			var c=$(document).find(".btn-red");
			$.each(c, function(c, n) {
				"eschedule-embedded-form"==$(n).attr("data-gacategory")&&$(n).click(function(c) {
					triggerEScheduleClicks()
				});
			});
			$(document).find("body#ppc-page section#hero #mPanel.schedule-service-panel > .panel-body-wrap a.schedule-service").click(function(c) {
				triggerEScheduleClicks();
			});
			$(document).find("button.schedule-service").click(function(c) {
				triggerEScheduleClicks();
			});
			$(document).find(".phone-formatted").click(function(c) {
				tallyPhnNumClicks();
			});
			$(document).find(".market-phones").click(function(c) {
				tallyPhnNumClicks();
			});
			$(document).find(".desktop-header-phone").click(function(c) {
				tallyPhnNumClicks();
			});
			$(document).find(".call-phone-number").click(function(c) {
				tallyPhnNumClicks();
			});
			$(document).find("#nav-phone-number").click(function(c) {
				tallyPhnNumClicks();
			});
			$(document).find(".local-page-phone").click(function(c) {
				tallyPhnNumClicks();
			});
			$(document).find("#mob-call-now").click(function(c) {
				tallyPhnNumClicks();
			});
			$(document).find("#local-page-contactus-sticky").click(function(c) {
				tallyPhnNumClicks();
			});
		} catch(e) {}
    }
} catch(c) {}

(function() {
	'use strict';
	var rrTest = {
		connectionSpeed: '${profile.geolocation.connectionSpeed}', 
		cityStateVal:'', 
		cityVal:'',
        stateVal:'',
		locationNotFound:false,
		debug:true,
		account : 'Roto-Rooter',
		portfolio : 'rotorooter.com',
		test : 'SEM AB Z2 Redesign Test 05182018',
		cookieName : 'RotoRooter',
		creative : "Experience C",
		widget: "div.ppc-content h2",
		slider: ".reviewSlideClass",
		widgetHeader: "div.plumbing-80-years",
		phnNumber: rotoRooterApp.session.franchisePhoneNumber,
		
		init: function() {		
			rrTest.debug = Boolean(helpers.getQueryParam('debug'));

			rrTest.log("Test Running...");
			rrTest.log(rrTest.account + " - " + rrTest.portfolio);
			rrTest.log(rrTest.test + " - " + rrTest.creative);
			
			//Check to see if the element that we're modifying for the test is present on the page
			rrTest.elementLoaded(rrTest.widget, function() {	
				rrTest.log("Test 1 Ready!");
				rrTest.chall();
			});
		},
		chall : function() {
			removeListeners();
			rrTest.addAddlJSCSS();
			rrTest.getGeo();
			
			/* WH */
			rrTest.elementLoaded(rrTest.widgetHeader, function() {	
				rrTest.log("Widget Ready!");
				rrTest.widgetTest();
			});
			/* End WH */
			
			rrTest.updateContent();
		
			rrTest.elementLoaded(rrTest.slider, function() {	
				rrTest.log("Slider Ready!");
				rrTest.chall2();
			});
			
			attachListeners();
		},
		widgetTest : function() {
			/* Update Header Text to include City */
			if(rrTest.cityVal !== '') {
				var txt = $(document).find('div.plumbing-80-years span').eq(0).text();
				txt = txt + " IN "+rrTest.cityVal.toUpperCase();
				$(document).find('div.plumbing-80-years span').text(txt);
			}
			/* Replace Blue Bar Contents with Coupon */
			var dataAmt = $(document).find('aside#PPCcoupons').find('a.coupon').attr('data-amount');
			var dataSrv = $(document).find('aside#PPCcoupons').find('a.coupon').attr('data-service');
			var dataLabel = $(document).find('aside#PPCcoupons').find('a.coupon').attr('data-galabel');
			var coupon = '<div id="header-coupon"><div id="coupon-icon"><em class="tk-material-icons">îˆ§</em></div><div id="coupon-text"><a href="#" class="coupon-link" data-toggle="modal" data-target="#couponModal" data-amount="'+dataAmt+'" data-service="'+dataSrv+'" data-gacategory="local-page" data-gaaction="click" data-galabel="'+dataLabel +'">Get '+dataAmt+'</a></div></div>';
			$(document).find('div#blue-bar').html(coupon);
		},
		chall2 : function() {
			console.log("slider...");
			window.clearTimeout(rrTest.eleTimer);
			try {
				var isSlickLoaded = (typeof $.fn.slick !== 'undefined');
				if(isSlickLoaded) {
					$('#reviewSlides').slick({
						dots: false,
						lazyLoad: 'ondemand',
						autoplay: false,
						infinite: false,
						nextArrow: '<button type="button" class="slick-next">&rsaquo;</button>', 
						prevArrow: '<button type="button" class="slick-prev">&lsaquo;</button>',
						responsive: [{breakpoint: 1024,settings: {slidesToShow: 1,infinite: false, centerPadding: '0'}},{breakpoint: 793,settings:{arrows: false}}]
					});
					
					$(document).find('div.slick-track').attr('id', 'slick-track-id')
					$(document).find('div.slick-track').attr('style', 'opacity: 1; transform: translate3d(-344px, 0px, 0px);')
					$(document).find('button.slick-prev').attr('aria-label', '&lsaquo;');
					$(document).find('button.slick-next').attr('aria-label', '&rsaquo;');
					
					$(document).find('div#reviewSlides').css('display','block');
					
					//GET $$ Off button -- dynamic serving of discount based on DMA
					var dataAmt = $(document).find('aside#PPCcoupons').find('a.coupon').attr('data-amount');
					var dataSrv = $(document).find('aside#PPCcoupons').find('a.coupon').attr('data-service');
					var dataLabel = $(document).find('aside#PPCcoupons').find('a.coupon').attr('data-galabel');

					var coupon = '<div class="coupon-div"> <a class="a-coupon" href="#" data-toggle="modal" data-target="#couponModal" data-amount="'+dataAmt+'" data-service="'+dataSrv+'" data-gacategory="local-page" data-gaaction="click" data-galabel="'+dataLabel +'">GET '+dataAmt+' OFF YOUR NEXT SERVICE<i class="tk-material-icons">îŒ•</i></a></div></div>';
					$(document).find('section#reviews').append(coupon);

					$(document).find('div.coupon-div a.a-coupon').before('<img id="rrVan" src="https://rotorooter.com/images/rr-van.png" > <img id="rrRedVan" src="https://rotorooter.com/images/rr-van-red-border.png" >');
					
					$(document).find('section#reviews').css('display','block');
				} else {
					rrTest.eleTimer = window.setTimeout(function(){rrTest.chall2();}, 100);
				}
			} catch(e) {
				console.log(e);
			}
		},
		addAddlJSCSS : function() {
			var sliderScriptSrc = '<script defer type="text/javascript" src="https://cdn.jsdelivr.net/npm/slick-carousel@1.6.0/slick/slick.min.js"><\/script>';
			var sliderCSSSrc = '<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.6.0/slick/slick.css"\/>';
			$("head").append(sliderScriptSrc);
			$("head").append(sliderCSSSrc);
		},
		updateContent: function() {			
		    var bqElm = $(document).find('blockquote').html();			
			var reviewSlideClass = '<div class="reviewSlideClass" id="reviewSlideId"><h2 class="tk-helvetica-neue" id="custRevs">CUSTOMER REVIEWS</h2><div id="reviewSlides"></div></div>';
			$(document).find('section#reviews').before(reviewSlideClass);			
			$(document).find('blockquote').appendTo('#reviewSlides');

			$(document).find('section#reviews h2.tk-helvetica-neue').remove();
			$(document).find('blockquote p.author-locale strong').before('<span>&ndash;</span>');
			$(document).find('div.content #main-content div.ppc-content h2').replaceWith('<h2>Our Full-Service Local Plumbers Provide Free Estimates on Any Job</h2>');
			//$(document).find('section#main-content div.ppc-content hr').remove();
			
			//Schedule Service Button
			$(document).find('.reviewSlideClass').append('<button class="scheduleServiceClass desktop" id="scheduleServiceId" data-toggle="modal" data-target="#scheduleServiceModal" data-gacategory="eschedule-embedded-form" data-gaaction="click" data-galabel="eschedule-open-modal"> <span class="tk-sans" style="font-family: \'acumin-pro\',\'Helvetica Neue\',\'Helvetica\',\'Arial\',sans-serif;visibility: visible"><i class="material-icons" style="bottom: auto;display: inline-block;font-size: 1.5rem;height: 1.5rem;line-height: 1.5rem;position: relative;top: .375rem;width: 1.75rem;">î˜”</i>Schedule Service Online</span></button>');
			$(document).find('section#reviews').append('<button class="scheduleServiceClass mobile" id="scheduleServiceId" data-toggle="modal" data-target="#scheduleServiceModal" data-gacategory="eschedule-embedded-form" data-gaaction="click" data-galabel="eschedule-open-modal"> <span class="tk-sans" style="font-family: \'acumin-pro\',\'Helvetica Neue\',\'Helvetica\',\'Arial\',sans-serif;visibility: visible"><i class="material-icons" style="bottom: auto;display: inline-block;font-size: 1.5rem;height: 1.5rem;line-height: 1.5rem;position: relative;top: .375rem;width: 1.75rem;">î˜”</i>Schedule Service Online</span></button>');
			$(document).find('a#back-to-top').before('<div id="back-to-top-container"></div>');
          	$(document).find('a#back-to-top').remove();
          	$(document).find('div#back-to-top-container').append('<a data-galabel="back-to-top" data-gaaction="click" data-gacategory="links" class="back-to-top" id="back-to-top"><i class="tk-material-icons">îŒ–</i>Back to Top</a>');

        },
		getGeo: function() {
			var connectionSpeed = '${profile.geolocation.connectionSpeed}';
			rrTest.stateVal = rrTest.abbrState('${profile.geolocation.state}');
			rrTest.cityStateVal = '${profile.geolocation.city}, '+rrTest.stateVal;
			rrTest.cityVal = '${profile.geolocation.city}';
			
			//If on broadband (ie WiFi) then populate the city and state
			if(connectionSpeed === 'broadband') {
				adobe.target.trackEvent( {
					mbox:"LocationIdentified", params: {
						LocationIdentified: 'YES'
					}
				});
			} else {
				//If on mobile (ie 4G etc) then use RotoRooter's Session values; If not available then do not populate city/state
				if(rotoRooterApp) {
					if(rotoRooterApp.session) {
						rrTest.cityVal = rotoRooterApp.session.marketCity;
						rrTest.cityStateVal = rrTest.cityVal+", "+rotoRooterApp.session.marketState;
					}
				} else {
					rrTest.locationNotFound = true;
					rrTest.cityVal = '';
					rrTest.cityStateVal = '';
				}
				adobe.target.trackEvent( {
					mbox:"LocationIdentified", params: {
						LocationIdentified: 'NO'
					}
				});
			}
		},
		abbrState: function(state) {
			var st;
			switch(state.toLowerCase()) {
				case "alabama":
					st="AL";
					break;
				case "alaska":
					st="AK";
					break;
				case "arizona":
					st="AZ";
					break;
				case "arkansas":
					st="AR";
					break;
				case "california":
					st="CA";
					break;
				case "colorado":
					st="CO";
					break;
				case "connecticut":
					st="CT";
					break;
				case "delaware":
					st="DE";
					break;
				case "florida":
					st="FL";
					break;
				case "georgia":
					st="GA";
					break;
				case "hawaii":
					st="HI";
					break;
				case "idaho":
					st="ID";
					break;
				case "illinois":
					st="IL";
					break;
				case "indiana":
					st="IN";
					break;
				case "iowa":
					st="IA";
					break;
				case "kansas":
					st="KS";
					break;
				case "kentucky":
					st="KY";
					break;
				case "louisiana":
					st="LA";
					break;
				case "maine":
					st="ME";
					break;
				case "maryland":
					st="MD";
					break;
				case "massachusetts":
					st="MA";
					break;
				case "michigan":
					st="MI";
					break;
				case "minnesota":
					st="MN";
					break;
				case "mississippi":
					st="MS";
					break;
				case "missouri":
					st="MO";
					break;
				case "montana":
					st="MT";
					break;
				case "nebraska":
					st="NE";
					break;
				case "nevada":
					st="NV";
					break;
				case "new hampshire":
					st="NH";
					break;
				case "new jersey":
					st="NJ";
					break;
				case "new mexico":
					st="NM";
					break;
				case "new york":
					st="NY";
					break;
				case "north carolina":
					st="NC";
					break;
				case "north dakota":
					st="ND";
					break;
				case "ohio":
					st="OH";
					break;
				case "oklahoma":
					st="OK";
					break;
				case "oregon":
					st="OR";
					break;
				case "pennsylvania":
					st="PA";
					break;
				case "rhode island":
					st="RI";
					break;
				case "south carolina":
					st="SC";
					break;
				case "south dakota":
					st="SD";
					break;
				case "tennessee":
					st="TN";
					break;
				case "texas":
					st="TX";
					break;
				case "utah":
					st="UT";
					break;
				case "vermont":
					st="VT";
					break;
				case "virginia":
					st="VA";
					break;
				case "washington":
					st="WA";
					break;
				case "west virginia":
					st="WV";
					break;
				case "wisconsin":
					st="WI";
					break;
				case "wyoming":
					st="WY";
					break;
				case "district of columbia":
					st="DC";
					break;
				default:
					st=null;
					break;
			}
			return st;
		},
		elementLoaded : function (ele, callback) {
			rrTest.log('elementLoaded::  ' + ele + " - Checking...");
			window.clearTimeout(rrTest.eleTimer);
			if (document.querySelectorAll(ele).length > 0) {
				if (typeof callback === 'function') {
					rrTest.log('elementLoaded::  ' + ele + " - Found!");
					callback();
				}
			} else {
				rrTest.eleTimer = window.setTimeout(function(){rrTest.elementLoaded(ele, callback);}, 100);
			}
		},
		dependsLoaded : function (callback) { 
			rrTest.log(rrTest.test + " - " + rrTest.creative + " - dependsLoaded - Start...");
			
			window.clearTimeout(rrTest.timer);
			//Check for jQuery and _a object
			if ((window.$ && $.isReady) || (window.jQuery && jQuery.isReady)) {
				if (typeof callback === "function") {
					rrTest.log(rrTest.test + " - " + rrTest.creative + " - dependsLoaded - Ready!");
					callback();
				}
			} else {
				rrTest.timer = window.setTimeout(function() {
					rrTest.dependsLoaded(callback);
				}, 100);
			}
		},
		log : function(obj){
			if(rrTest.debug === true){
				console.log(obj);
			}
		}
	}	

	var helpers = {
		getQueryParam: function(variable) {
	      var query = window.location.search.substring(1);
	      var vars = query.split('&');
	      for (var i = 0; i < vars.length; i++) {
	        var pair = vars[i].split('=');
	        if (decodeURIComponent(pair[0]) == variable) {
	        	return decodeURIComponent(pair[1]);
	        }
	      }
	    }
	}

	rrTest.dependsLoaded(function(){ 
		rrTest.init();
	});
})();
</script>